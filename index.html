<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Peak TCS | Employment Pre-Application</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #0F172A;
            --primary-light: #1E293B;
            --accent: #FF6B35;  /* Peak Orange */
            --accent-dark: #E55A2B;  /* Darker Peak Orange */
            --success: #10B981;
            --warning: #F59E0B;
            --error: #EF4444;
            --text: #1F2937;
            --text-light: #6B7280;
            --border: #E5E7EB;
            --bg: #FFFFFF;
            --bg-secondary: #F9FAFB;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #FF6B35 0%, #E55A2B 100%);
            min-height: 100vh;
            padding: 2rem 1rem;
            color: var(--text);
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background: var(--bg);
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.2);
            overflow: hidden;
        }

        .header {
            background: var(--primary);
            color: white;
            padding: 2.5rem 2rem;
            text-align: center;
        }

        .header h1 {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .header p {
            color: rgba(255,255,255,0.8);
            font-size: 0.95rem;
        }

        .header a {
            color: var(--accent);
        }

        .progress-bar {
            height: 4px;
            background: #E5E7EB;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent), #FF8C61);
            transition: width 0.3s ease;
        }

        .progress-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 2rem;
            background: var(--bg-secondary);
            font-size: 0.875rem;
            color: var(--text-light);
        }

        .time-estimate {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .time-estimate svg {
            width: 16px;
            height: 16px;
        }

        .step-indicator {
            font-weight: 600;
            color: var(--accent);
        }

        .form-container {
            padding: 2.5rem 2rem;
        }

        .step {
            display: none;
        }

        .step.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
        }

        .section-subtitle {
            color: var(--text-light);
            font-size: 0.95rem;
            margin-bottom: 2rem;
        }

        .form-group {
            margin-bottom: 1.75rem;
        }

        label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--text);
            font-size: 0.95rem;
        }

        .required {
            color: var(--error);
            margin-left: 0.25rem;
        }

        input[type="text"],
        input[type="email"],
        input[type="tel"],
        input[type="date"],
        select,
        textarea {
            width: 100%;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1rem;
            font-family: inherit;
            transition: all 0.2s;
            background: var(--bg);
        }

        input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--accent);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        textarea {
            resize: vertical;
            min-height: 120px;
        }

        .textarea-wrapper {
            position: relative;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 0.75rem;
            color: var(--text-light);
            background: white;
            padding: 2px 6px;
            border-radius: 4px;
            pointer-events: none;
        }

        .char-counter.warning {
            color: var(--warning);
        }

        .char-counter.error {
            color: var(--error);
        }

        .help-text-toggle {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent);
            font-size: 0.875rem;
            cursor: pointer;
            margin-top: 0.5rem;
            padding: 0.5rem;
            border-radius: 6px;
            transition: background 0.2s;
        }

        .help-text-toggle:hover {
            background: rgba(59, 130, 246, 0.1);
        }

        .help-text-toggle svg {
            width: 16px;
            height: 16px;
            transition: transform 0.2s;
        }

        .help-text-toggle.expanded svg {
            transform: rotate(180deg);
        }

        .help-text-content {
            display: none;
            margin-top: 0.75rem;
            padding: 1rem;
            background: #EFF6FF;
            border-left: 3px solid var(--accent);
            border-radius: 6px;
            font-size: 0.875rem;
            line-height: 1.6;
        }

        .help-text-content.show {
            display: block;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .help-example {
            margin-top: 0.75rem;
        }

        .help-example-label {
            font-weight: 600;
            color: var(--success);
            margin-bottom: 0.25rem;
        }

        .help-example-bad {
            font-weight: 600;
            color: var(--error);
            margin-bottom: 0.25rem;
        }

        .help-example-text {
            font-style: italic;
            color: var(--text-light);
            padding: 0.5rem;
            background: white;
            border-radius: 4px;
            margin-bottom: 0.5rem;
        }

        .radio-group,
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .radio-option,
        .checkbox-option {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            position: relative;
        }

        .radio-option:hover,
        .checkbox-option:hover {
            border-color: var(--accent);
            background: rgba(59, 130, 246, 0.05);
        }

        .radio-option input[type="radio"]:checked + label,
        .checkbox-option input[type="checkbox"]:checked + label {
            font-weight: 600;
            color: var(--accent);
        }

        .radio-option input,
        .checkbox-option input {
            margin-right: 0.75rem;
            width: 20px;
            height: 20px;
            cursor: pointer;
            flex-shrink: 0;
        }

        .radio-option label,
        .checkbox-option label {
            cursor: pointer;
            margin-bottom: 0;
            font-weight: 500;
            flex: 1;
        }

        .address-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        .address-grid .row-2 {
            grid-template-columns: 2fr 1fr;
            display: grid;
            gap: 1rem;
        }

        .address-grid .row-3 {
            grid-template-columns: 1fr 1fr 1fr;
            display: grid;
            gap: 1rem;
        }

        .phone-input {
            display: grid;
            grid-template-columns: 1fr 1fr 1.5fr;
            gap: 0.5rem;
            align-items: center;
        }

        .phone-input span {
            text-align: center;
            font-weight: 600;
            color: var(--text-light);
        }

        .file-upload {
            border: 2px dashed var(--border);
            border-radius: 8px;
            padding: 2rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .file-upload:hover {
            border-color: var(--accent);
            background: rgba(59, 130, 246, 0.05);
        }

        .file-upload input {
            display: none;
        }

        .file-upload-text {
            color: var(--text-light);
            font-size: 0.95rem;
        }

        .file-name {
            margin-top: 0.5rem;
            color: var(--accent);
            font-weight: 600;
        }

        .availability-grid {
            display: grid;
            gap: 1rem;
        }

        .day-availability {
            border: 2px solid var(--border);
            border-radius: 8px;
            padding: 1rem;
        }

        .day-availability h4 {
            margin-bottom: 0.75rem;
            color: var(--primary);
        }

        .time-slots {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .time-slot {
            flex: 0 0 auto;
        }

        .time-slot input {
            display: none;
        }

        .time-slot label {
            display: inline-block;
            padding: 0.5rem 1rem;
            border: 2px solid var(--border);
            border-radius: 6px;
            font-size: 0.875rem;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }

        .time-slot input:checked + label {
            background: var(--accent);
            border-color: var(--accent);
            color: white;
        }

        .time-slot label:hover {
            border-color: var(--accent);
        }

        .bio-section {
            background: linear-gradient(135deg, #667eea15 0%, #764ba215 100%);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
            border: 2px solid #667eea30;
        }

        .bio-section h3 {
            color: var(--primary);
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .bio-section .subtitle {
            color: var(--text-light);
            font-size: 0.9rem;
            margin-bottom: 1.5rem;
        }

        .button-group {
            display: flex;
            gap: 1rem;
            margin-top: 2rem;
            padding-top: 2rem;
            border-top: 2px solid var(--border);
        }

        button {
            flex: 1;
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }

        .btn-primary {
            background: var(--accent);
            color: white;
        }

        .btn-primary:hover {
            background: var(--accent-dark);
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
        }

        .btn-secondary {
            background: var(--bg-secondary);
            color: var(--text);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .alert {
            padding: 1rem 1.25rem;
            border-radius: 8px;
            margin-bottom: 1.5rem;
            font-size: 0.95rem;
        }

        .alert-info {
            background: #DBEAFE;
            color: #1E40AF;
            border-left: 4px solid var(--accent);
        }

        .alert-warning {
            background: #FEF3C7;
            color: #92400E;
            border-left: 4px solid var(--warning);
        }

        .success-screen {
            display: none;
            text-align: center;
            padding: 3rem 2rem;
        }

        .success-screen.active {
            display: block;
        }

        .success-icon {
            width: 80px;
            height: 80px;
            background: var(--success);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1.5rem;
            font-size: 3rem;
        }

        .score-display {
            background: var(--bg-secondary);
            border-radius: 12px;
            padding: 2rem;
            margin: 2rem 0;
        }

        .score-display h3 {
            color: var(--primary);
            margin-bottom: 1rem;
        }

        .score-bar {
            height: 40px;
            background: var(--border);
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .score-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--success), #059669);
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 1rem;
            color: white;
            font-weight: 700;
            transition: width 1s ease;
        }

        @media (max-width: 640px) {
            body {
                padding: 0.5rem;
            }

            .container {
                border-radius: 12px;
            }

            .form-container {
                padding: 1.5rem 1rem;
            }

            .header {
                padding: 2rem 1.5rem;
            }

            .header h1 {
                font-size: 1.5rem;
            }

            .progress-info {
                padding: 0.75rem 1rem;
                flex-direction: column;
                gap: 0.5rem;
                text-align: center;
            }

            .button-group {
                flex-direction: column-reverse;
                gap: 0.75rem;
            }

            button {
                width: 100%;
                min-height: 48px; /* Better touch target */
                font-size: 1rem;
            }

            input[type="text"],
            input[type="email"],
            input[type="tel"],
            input[type="date"],
            input[type="file"],
            select,
            textarea {
                font-size: 16px; /* Prevents zoom on iOS */
                min-height: 44px; /* Better touch target */
            }

            .radio-option,
            .checkbox-option {
                min-height: 48px; /* Better touch target */
                padding: 0.875rem;
            }

            .radio-option label,
            .checkbox-option label {
                font-size: 0.95rem;
            }

            .address-grid .row-2,
            .address-grid .row-3 {
                grid-template-columns: 1fr;
            }

            .time-slots {
                flex-direction: column;
            }

            .time-slot label {
                width: 100%;
                text-align: center;
                min-height: 44px;
            }

            .file-upload {
                min-height: 120px;
            }

            .section-title {
                font-size: 1.25rem;
            }

            .section-subtitle {
                font-size: 0.9rem;
            }

            textarea {
                min-height: 100px;
                padding-bottom: 2rem; /* Space for char counter */
            }

            .char-counter {
                font-size: 0.7rem;
            }
        }

        .loading {
            display: none;
            text-align: center;
            padding: 2rem;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            border: 4px solid var(--border);
            border-top: 4px solid var(--accent);
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Employment Pre-Application</h1>
            <p>Peak Talent Capital Solutions | Questions? <a href="/cdn-cgi/l/email-protection#6c18090d012c1c090d07180f1f420f0301"><span class="__cf_email__" data-cfemail="6c18090d012c1c090d07180f1f420f0301">[email&#160;protected]</span></a></p>
        </div>

        <div class="progress-bar">
            <div class="progress-fill" id="progressBar" style="width: 0%"></div>
        </div>

        <div class="progress-info">
            <div class="step-indicator">
                <span id="currentStepNum">1</span> of 6
            </div>
            <div class="time-estimate">
                <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                </svg>
                <span id="timeEstimate">~8 minutes remaining</span>
            </div>
        </div>

        <div class="form-container">
            <form id="applicationForm">
                
                <!-- STEP 1: Eligibility -->
                <div class="step active" data-step="1">
                    <h2 class="section-title">Eligibility Verification</h2>
                    <p class="section-subtitle">Let's confirm a few basic requirements to get started.</p>

                    <div class="form-group">
                        <div style="font-weight: 600; margin-bottom: 0.5rem; color: var(--text); font-size: 0.95rem;">
                            I certify that I am 18 years of age or older <span class="required">*</span>
                        </div>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="age_yes" name="age_18" value="Yes" required>
                                <label for="age_yes">Yes</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="age_no" name="age_18" value="No">
                                <label for="age_no">No</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div style="font-weight: 600; margin-bottom: 0.5rem; color: var(--text); font-size: 0.95rem;">
                            Are you legally eligible to work in the USA? <span class="required">*</span>
                        </div>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="eligible_yes" name="work_eligible" value="Yes" required>
                                <label for="eligible_yes">Yes</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="eligible_no" name="work_eligible" value="No">
                                <label for="eligible_no">No</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <div style="font-weight: 600; margin-bottom: 0.5rem; color: var(--text); font-size: 0.95rem;">
                            Can you provide proof of eligibility upon request? <span class="required">*</span>
                        </div>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="proof_yes" name="proof_eligible" value="Yes" required>
                                <label for="proof_yes">Yes</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="proof_no" name="proof_eligible" value="No">
                                <label for="proof_no">No</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="dl_number">Driver License Number (for verification) <span class="required">*</span></label>
                        <input type="text" id="dl_number" name="dl_number" required>
                    </div>

                    <div class="form-group">
                        <label for="dl_state">Driver License State <span class="required">*</span></label>
                        <input type="text" id="dl_state" name="dl_state" required>
                    </div>
                </div>

                <!-- STEP 2: Basic Information -->
                <div class="step" data-step="2">
                    <h2 class="section-title">Basic Information</h2>
                    <p class="section-subtitle">Tell us about yourself.</p>

                    <div class="form-group">
                        <label for="legal_name">Legal Name (First, Middle, Last - include Jr., Sr., III, etc.) <span class="required">*</span></label>
                        <input type="text" id="legal_name" name="legal_name" required>
                    </div>

                    <div class="form-group">
                        <label for="email">Email Address <span class="required">*</span></label>
                        <input type="email" id="email" name="email" required>
                    </div>

                    <!-- Honeypot field for spam protection - hidden from humans -->
                    <div class="form-group" style="position: absolute; left: -9999px; opacity: 0; pointer-events: none;" aria-hidden="true" tabindex="-1">
                        <label for="website_url">Website (leave blank)</label>
                        <input type="text" id="website_url" name="website_url" autocomplete="off" tabindex="-1">
                    </div>

                    <div class="form-group">
                        <label>Address (Physical street address - NO PO Box) <span class="required">*</span></label>
                        <div class="address-grid">
                            <input type="text" id="address_1" name="address_1" placeholder="Street Address" required>
                            <input type="text" id="address_2" name="address_2" placeholder="Address Line 2 (Optional)">
                            <div class="row-2">
                                <input type="text" id="city" name="city" placeholder="City" required>
                                <input type="text" id="state" name="state" placeholder="State" required>
                            </div>
                            <div class="row-3">
                                <input type="text" id="zip" name="zip" placeholder="Zip Code" required>
                                <select id="country" name="country" required>
                                    <option value="">Select Country</option>
                                    <option value="United States" selected>United States</option>
                                    <option value="Canada">Canada</option>
                                    <option value="Mexico">Mexico</option>
                                </select>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Phone Number <span class="required">*</span></label>
                        <div class="phone-input">
                            <input type="tel" id="phone_1" name="phone_1" maxlength="3" placeholder="555" required>
                            <span>-</span>
                            <input type="tel" id="phone_2" name="phone_2" maxlength="3" placeholder="123" required>
                            <span>-</span>
                            <input type="tel" id="phone_3" name="phone_3" maxlength="4" placeholder="4567" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="emergency_contact">Emergency Contact (First and Last Name) <span class="required">*</span></label>
                        <input type="text" id="emergency_contact" name="emergency_contact" required>
                    </div>

                    <div class="form-group">
                        <label>Emergency Contact Phone Number <span class="required">*</span></label>
                        <div class="phone-input">
                            <input type="tel" id="emerg_phone_1" name="emerg_phone_1" maxlength="3" placeholder="555" required>
                            <span>-</span>
                            <input type="tel" id="emerg_phone_2" name="emerg_phone_2" maxlength="3" placeholder="123" required>
                            <span>-</span>
                            <input type="tel" id="emerg_phone_3" name="emerg_phone_3" maxlength="4" placeholder="4567" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="hear_about">How did you hear about us? <span class="required">*</span></label>
                        <select id="hear_about" name="hear_about" required>
                            <option value="">Select One</option>
                            <option value="Peak Website">Peak Website</option>
                            <option value="Search Engine">Search Engine (Google, Bing, etc.)</option>
                            <option value="Job Posting Site">Job Posting Site (Indeed, Monster, etc.)</option>
                            <option value="Social Media">Social Media</option>
                            <option value="Radio, Newspaper, TV">Radio, Newspaper, TV</option>
                            <option value="Dept. of Labor">Dept. of Labor</option>
                            <option value="Job Fair">Job Fair / Event</option>
                            <option value="Client Referral">Client Referral</option>
                            <option value="Company Referral">Company Referral</option>
                            <option value="Friend Referral">Friend Referral</option>
                            <option value="Other">Other</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="referral_name">If referred, please list who</label>
                        <input type="text" id="referral_name" name="referral_name">
                    </div>

                    <div class="form-group">
                        <label for="salary_expectation">Salary/Pay Expectation <span class="required">*</span></label>
                        <input type="text" id="salary_expectation" name="salary_expectation" placeholder="e.g., $18/hour or $40,000/year" required>
                    </div>
                </div>

                <!-- STEP 3: Availability -->
                <div class="step" data-step="3">
                    <h2 class="section-title">Availability</h2>
                    <p class="section-subtitle">Let us know when you're available to work.</p>

                    <div class="form-group">
                        <div style="font-weight: 600; margin-bottom: 0.5rem; color: var(--text); font-size: 0.95rem;">
                            Job Type Desired <span class="required">*</span>
                        </div>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="job_full" name="job_type" value="Full Time (40+ hours/week)" required>
                                <label for="job_full">Full Time (40+ hours/week)</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="job_part" name="job_type" value="Part Time (20-39 hours/week)">
                                <label for="job_part">Part Time (20-39 hours/week)</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="job_occasional" name="job_type" value="Occasional (under 20 hours/week)">
                                <label for="job_occasional">Occasional (under 20 hours/week)</label>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="start_date">Date Available to Start <span class="required">*</span></label>
                        <input type="date" id="start_date" name="start_date" required>
                    </div>

                    <div class="form-group">
                        <label for="preferred_position">Preferred Position (Optional)</label>
                        <input type="text" id="preferred_position" name="preferred_position" placeholder="Leave blank if this is a general application">
                    </div>

                    <div class="alert alert-info">
                        <strong>ðŸ“… Your Availability:</strong> For each day, tell us what hours you are available to work. We'll match you with positions that fit your schedule.
                    </div>

                    <div class="availability-grid">
                        <div class="day-availability">
                            <h4>Monday <span class="required">*</span></h4>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="mon_all" name="monday" value="Available all day" required>
                                    Available all day
                                </label>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="mon_custom" name="monday" value="Specific hours">
                                    Specific hours (enter below)
                                </label>
                                <input type="text" id="mon_hours" name="monday_hours" placeholder="e.g., 7am-3pm, 2pm-10pm, etc." style="margin-top: 0.5rem;">
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="mon_not" name="monday" value="Not available">
                                    Not available
                                </label>
                            </div>
                        </div>

                        <div class="day-availability">
                            <h4>Tuesday <span class="required">*</span></h4>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="tue_all" name="tuesday" value="Available all day" required>
                                    Available all day
                                </label>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="tue_custom" name="tuesday" value="Specific hours">
                                    Specific hours (enter below)
                                </label>
                                <input type="text" id="tue_hours" name="tuesday_hours" placeholder="e.g., 7am-3pm, 2pm-10pm, etc." style="margin-top: 0.5rem;">
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="tue_not" name="tuesday" value="Not available">
                                    Not available
                                </label>
                            </div>
                        </div>

                        <div class="day-availability">
                            <h4>Wednesday <span class="required">*</span></h4>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="wed_all" name="wednesday" value="Available all day" required>
                                    Available all day
                                </label>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="wed_custom" name="wednesday" value="Specific hours">
                                    Specific hours (enter below)
                                </label>
                                <input type="text" id="wed_hours" name="wednesday_hours" placeholder="e.g., 7am-3pm, 2pm-10pm, etc." style="margin-top: 0.5rem;">
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="wed_not" name="wednesday" value="Not available">
                                    Not available
                                </label>
                            </div>
                        </div>

                        <div class="day-availability">
                            <h4>Thursday <span class="required">*</span></h4>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="thu_all" name="thursday" value="Available all day" required>
                                    Available all day
                                </label>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="thu_custom" name="thursday" value="Specific hours">
                                    Specific hours (enter below)
                                </label>
                                <input type="text" id="thu_hours" name="thursday_hours" placeholder="e.g., 7am-3pm, 2pm-10pm, etc." style="margin-top: 0.5rem;">
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="thu_not" name="thursday" value="Not available">
                                    Not available
                                </label>
                            </div>
                        </div>

                        <div class="day-availability">
                            <h4>Friday <span class="required">*</span></h4>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="fri_all" name="friday" value="Available all day" required>
                                    Available all day
                                </label>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="fri_custom" name="friday" value="Specific hours">
                                    Specific hours (enter below)
                                </label>
                                <input type="text" id="fri_hours" name="friday_hours" placeholder="e.g., 7am-3pm, 2pm-10pm, etc." style="margin-top: 0.5rem;">
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="fri_not" name="friday" value="Not available">
                                    Not available
                                </label>
                            </div>
                        </div>

                        <div class="day-availability">
                            <h4>Saturday <span class="required">*</span></h4>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="sat_all" name="saturday" value="Available all day" required>
                                    Available all day
                                </label>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="sat_custom" name="saturday" value="Specific hours">
                                    Specific hours (enter below)
                                </label>
                                <input type="text" id="sat_hours" name="saturday_hours" placeholder="e.g., 7am-3pm, 2pm-10pm, etc." style="margin-top: 0.5rem;">
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="sat_not" name="saturday" value="Not available">
                                    Not available
                                </label>
                            </div>
                        </div>

                        <div class="day-availability">
                            <h4>Sunday <span class="required">*</span></h4>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="sun_all" name="sunday" value="Available all day" required>
                                    Available all day
                                </label>
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="sun_custom" name="sunday" value="Specific hours">
                                    Specific hours (enter below)
                                </label>
                                <input type="text" id="sun_hours" name="sunday_hours" placeholder="e.g., 7am-3pm, 2pm-10pm, etc." style="margin-top: 0.5rem;">
                            </div>
                            <div class="form-group">
                                <label>
                                    <input type="radio" id="sun_not" name="sunday" value="Not available">
                                    Not available
                                </label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- STEP 4: Work Capacity Assessment (BIO Screening) -->
                <div class="step" data-step="4">
                    <h2 class="section-title">Work Capacity Assessment</h2>
                    <p class="section-subtitle">These questions help us understand how you approach work challenges.</p>

                    <div class="bio-section">
                        <h3>ðŸ“Š Understanding Your Work Style</h3>
                        <p class="subtitle">There are no "right" answers - we're looking for honest self-assessment about how you work.</p>
                    </div>

                    <div class="form-group">
                        <label for="bio_1">When working on a difficult task, how do you typically respond when you hit obstacles? <span class="required">*</span></label>
                        <select id="bio_1" name="bio_1" required>
                            <option value="">Select one...</option>
                            <option value="5">I push through obstacles and figure out solutions on my own</option>
                            <option value="4">I try to solve it myself first, then ask for help if needed</option>
                            <option value="3">I usually need guidance when I get stuck</option>
                            <option value="2">I often wait for someone to tell me what to do next</option>
                            <option value="1">I prefer tasks where I'm unlikely to encounter obstacles</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="bio_2">Describe a time when you had to keep working on something repetitive or boring for an extended period. How did you handle it? <span class="required">*</span></label>
                        
                        <div class="help-text-toggle" data-target="help-bio-2">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            See example
                        </div>
                        
                        <div class="help-text-content" id="help-bio-2">
                            <div>We want to understand how you maintain focus and effort during monotonous tasks. The best answers include specific details about what you did and how you stayed engaged.</div>
                            
                            <div class="help-example">
                                <div class="help-example-label">âœ“ Strong Example:</div>
                                <div class="help-example-text">"At my warehouse job, I spent 6 months scanning boxes daily. I stayed motivated by setting personal efficiency goals and tracking my accuracy rate. I also listened to podcasts to keep mentally engaged while maintaining my scan speed."</div>
                            </div>
                            
                            <div class="help-example">
                                <div class="help-example-bad">âœ— Weak Example:</div>
                                <div class="help-example-text">"I just did it." or "I worked hard."</div>
                            </div>
                        </div>
                        
                        <div class="textarea-wrapper">
                            <textarea id="bio_2" name="bio_2" required placeholder="Share a specific example..." maxlength="1000"></textarea>
                            <div class="char-counter" data-counter="bio_2">0/1000</div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="bio_3">When you receive critical feedback about your work, what's your typical response? <span class="required">*</span></label>
                        <select id="bio_3" name="bio_3" required>
                            <option value="">Select one...</option>
                            <option value="5">I actively seek feedback and use it to improve immediately</option>
                            <option value="4">I listen carefully and make corrections</option>
                            <option value="3">I sometimes get defensive but eventually make changes</option>
                            <option value="2">I find critical feedback discouraging</option>
                            <option value="1">I prefer to work in situations where I won't receive negative feedback</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="bio_4">If someone interrupts you while you're focused on a task, how does this affect your work? <span class="required">*</span></label>
                        <select id="bio_4" name="bio_4" required>
                            <option value="">Select one...</option>
                            <option value="5">I can handle interruptions and quickly get back on track</option>
                            <option value="4">Minor interruptions don't bother me much</option>
                            <option value="3">I need a few minutes to refocus after interruptions</option>
                            <option value="2">Interruptions significantly disrupt my productivity</option>
                            <option value="1">I have trouble completing tasks if interrupted</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="bio_5">Tell us about a mistake you made at work or school. What did you do about it? <span class="required">*</span></label>
                        
                        <div class="help-text-toggle" data-target="help-bio-5">
                            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            See example
                        </div>
                        
                        <div class="help-text-content" id="help-bio-5">
                            <div>We're looking for honesty and accountability. The best answers show you take responsibility, learn from mistakes, and take action to fix problems.</div>
                            
                            <div class="help-example">
                                <div class="help-example-label">âœ“ Strong Example:</div>
                                <div class="help-example-text">"I accidentally entered wrong inventory numbers that caused a shipping delay. I immediately told my supervisor, helped track down the correct items, and created a double-check system to prevent it from happening again."</div>
                            </div>
                            
                            <div class="help-example">
                                <div class="help-example-bad">âœ— Weak Example:</div>
                                <div class="help-example-text">"I don't really make mistakes." or "It wasn't my fault."</div>
                            </div>
                        </div>
                        
                        <div class="textarea-wrapper">
                            <textarea id="bio_5" name="bio_5" required placeholder="Describe the situation and your response..." maxlength="1000"></textarea>
                            <div class="char-counter" data-counter="bio_5">0/1000</div>
                        </div>
                    </div>
                </div>

                <!-- STEP 5: Experience & Education -->
                <div class="step" data-step="5">
                    <h2 class="section-title">Experience & Education</h2>
                    <p class="section-subtitle">Tell us about your background.</p>

                    <div class="alert alert-info">
                        <strong>Don't have a resume?</strong> Peak offers Custom Resume Builder service starting at $25. Upload a document stating your interest and basic experience, and we'll contact you for a free consultation.
                    </div>

                    <div class="form-group">
                        <label for="resume">Upload Resume (Optional)</label>
                        <div class="file-upload" id="fileUploadArea">
                            <input type="file" id="resume" name="resume" accept=".pdf,.doc,.docx">
                            <div class="file-upload-text">
                                Click to upload or drag and drop<br>
                                <small>PDF, DOC, or DOCX (Max 10MB)</small>
                            </div>
                            <div class="file-name" id="fileName"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="work_experience">Previous Work Experience <span class="required">*</span></label>
                        <textarea id="work_experience" name="work_experience" required placeholder="Please list three (3) previous work experiences. If you don't have three, list as many as applicable. Include employer name, position, dates, and key responsibilities."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="references">Professional References <span class="required">*</span></label>
                        <textarea id="references" name="references" required placeholder="Please list three (3) professional references. Include name, relationship (boss/coworker/etc.), company, and phone number."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="education">Highest Level of Education <span class="required">*</span></label>
                        <select id="education" name="education" required>
                            <option value="">Select one...</option>
                            <option value="Some High School">Some High School</option>
                            <option value="High School Diploma or GED">High School Diploma or GED</option>
                            <option value="Postsecondary non-degree">Postsecondary non-degree</option>
                            <option value="Some College / Currently Enrolled">Some College / Currently Enrolled</option>
                            <option value="Associate's Degree">Associate's Degree</option>
                            <option value="Bachelor's Degree">Bachelor's Degree</option>
                            <option value="Master's Degree">Master's Degree</option>
                            <option value="Doctoral or Professional Degree">Doctoral or Professional Degree</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label for="skills">What makes you a great applicant?</label>
                        <textarea id="skills" name="skills" placeholder="Tell us about your skills, abilities, and other relevant information we should consider."></textarea>
                    </div>

                    <div class="form-group">
                        <label for="certifications">Professional Licenses or Certifications</label>
                        <textarea id="certifications" name="certifications" placeholder="List any relevant licenses or certifications you hold."></textarea>
                    </div>
                </div>

                <!-- STEP 6: Review & Submit -->
                <div class="step" data-step="6">
                    <h2 class="section-title">Review & Submit</h2>
                    <p class="section-subtitle">Please review the EEO statement and certify your application.</p>

                    <div class="alert alert-warning">
                        <strong>Peak is an Equal Opportunity Employer</strong><br><br>
                        It is the policy of Peak Employment Solutions, LLC to provide equal employment opportunity (EEO) to all persons regardless of age, color, national origin, citizenship status, physical or mental disability, race, religion, creed, gender, sex, sexual orientation, gender identity and/or expression, genetic information, marital status, status with regard to public assistance, veteran status, or any other characteristic protected by federal, state or local law. Peak will provide reasonable accommodations for qualified individuals with disabilities.
                    </div>

                    <div class="form-group">
                        <div style="font-weight: 600; margin-bottom: 0.5rem; color: var(--text); font-size: 0.95rem;">
                            Certification <span class="required">*</span>
                        </div>
                        <div class="radio-group">
                            <div class="radio-option">
                                <input type="radio" id="cert_agree" name="certification" value="I agree" required>
                                <label for="cert_agree">I agree - All information submitted is true to the best of my knowledge</label>
                            </div>
                            <div class="radio-option">
                                <input type="radio" id="cert_disagree" name="certification" value="I do not agree">
                                <label for="cert_disagree">I do not agree</label>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="button-group">
                    <button type="button" class="btn-secondary" id="prevBtn" style="display: none;">â† Previous</button>
                    <button type="button" class="btn-primary" id="nextBtn">Next â†’</button>
                    <button type="submit" class="btn-primary" id="submitBtn" style="display: none;">Submit Application</button>
                </div>
            </form>

            <!-- Loading Screen -->
            <div class="loading" id="loadingScreen">
                <div class="spinner"></div>
                <h3>Submitting your application...</h3>
                <p>Please wait while we process your information.</p>
            </div>

            <!-- Success Screen -->
            <div class="success-screen" id="successScreen">
                <div class="success-icon">âœ“</div>
                <h2 class="section-title">Application Submitted Successfully!</h2>
                <p style="color: var(--text-light); margin: 1rem 0 2rem;">Thank you for applying to Peak Talent Capital Solutions.</p>
                
                <div class="score-display" id="scoreDisplay">
                    <h3>Your Work Capacity Score</h3>
                    <div class="score-bar">
                        <div class="score-fill" id="scoreFill" style="width: 0%">
                            <span id="scoreText">0%</span>
                        </div>
                    </div>
                    <p style="margin-top: 1rem; color: var(--text-light);" id="scoreMessage"></p>
                </div>

                <div style="background: var(--bg-secondary); padding: 1.5rem; border-radius: 8px; margin-top: 2rem;">
                    <h4 style="margin-bottom: 0.5rem;">What happens next?</h4>
                    <p style="color: var(--text-light); font-size: 0.95rem;" id="nextSteps"></p>
                </div>
            </div>
        </div>
    </div>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
        // Form state management
        let currentStep = 1;
        const totalSteps = 6;
        let formData = {};
        
        // Time estimates per step (in seconds)
        const stepTimes = {
            1: 60,   // Eligibility: 1 minute
            2: 120,  // Basic Info: 2 minutes
            3: 90,   // Availability: 1.5 minutes
            4: 180,  // BIO Assessment: 3 minutes (longest)
            5: 120,  // Experience: 2 minutes
            6: 30    // Review: 30 seconds
        };
        
        // Update time estimate
        function updateTimeEstimate() {
            let remainingTime = 0;
            for (let step = currentStep; step <= totalSteps; step++) {
                remainingTime += stepTimes[step];
            }
            
            const minutes = Math.ceil(remainingTime / 60);
            const timeText = minutes === 1 ? '~1 minute remaining' : `~${minutes} minutes remaining`;
            document.getElementById('timeEstimate').textContent = timeText;
            document.getElementById('currentStepNum').textContent = currentStep;
        }
        
        // Character counter functionality
        function setupCharCounters() {
            const textareas = document.querySelectorAll('textarea[maxlength]');
            textareas.forEach(textarea => {
                const counter = document.querySelector(`[data-counter="${textarea.id}"]`);
                if (counter) {
                    textarea.addEventListener('input', () => {
                        const current = textarea.value.length;
                        const max = textarea.maxLength;
                        counter.textContent = `${current}/${max}`;
                        
                        // Change color based on length
                        counter.classList.remove('warning', 'error');
                        if (current > max * 0.9) {
                            counter.classList.add('error');
                        } else if (current > max * 0.75) {
                            counter.classList.add('warning');
                        }
                    });
                }
            });
        }
        
        // Help text toggle functionality
        function setupHelpTextToggles() {
            const toggles = document.querySelectorAll('.help-text-toggle');
            toggles.forEach(toggle => {
                toggle.addEventListener('click', () => {
                    const targetId = toggle.getAttribute('data-target');
                    const content = document.getElementById(targetId);
                    
                    if (content) {
                        const isExpanded = content.classList.contains('show');
                        content.classList.toggle('show');
                        toggle.classList.toggle('expanded');
                    }
                });
            });
        }

        // Auto-save to localStorage
        function autoSave() {
            const form = document.getElementById('applicationForm');
            const formDataObj = new FormData(form);
            const data = {};
            for (let [key, value] of formDataObj.entries()) {
                data[key] = value;
            }
            localStorage.setItem('peakApplication', JSON.stringify(data));
        }

        // Load saved data
        function loadSaved() {
            const saved = localStorage.getItem('peakApplication');
            if (saved) {
                const data = JSON.parse(saved);
                for (let key in data) {
                    const input = document.querySelector(`[name="${key}"]`);
                    if (input) {
                        // Skip file inputs - they can't be restored from localStorage
                        if (input.type === 'file') {
                            continue;
                        }
                        
                        if (input.type === 'radio') {
                            const radio = document.querySelector(`[name="${key}"][value="${data[key]}"]`);
                            if (radio) radio.checked = true;
                        } else {
                            input.value = data[key];
                        }
                    }
                }
            }
        }

        // Auto-save on input change
        document.getElementById('applicationForm').addEventListener('change', autoSave);
        document.getElementById('applicationForm').addEventListener('input', autoSave);

        // Load saved data on page load
        window.addEventListener('load', loadSaved);

        // Make radio/checkbox options clickable
        document.querySelectorAll('.radio-option, .checkbox-option').forEach(option => {
            option.addEventListener('click', (e) => {
                // Don't double-trigger if clicking the input directly
                if (e.target.tagName !== 'INPUT') {
                    const input = option.querySelector('input');
                    if (input) {
                        input.checked = true;
                        // Trigger change event for validation and auto-save
                        input.dispatchEvent(new Event('change', { bubbles: true }));
                    }
                }
            });
        });

        // Phone number auto-tab
        function setupPhoneAutoTab() {
            const phoneInputs = [
                ['phone_1', 'phone_2'],
                ['phone_2', 'phone_3'],
                ['emerg_phone_1', 'emerg_phone_2'],
                ['emerg_phone_2', 'emerg_phone_3']
            ];

            phoneInputs.forEach(([current, next]) => {
                const currentInput = document.getElementById(current);
                const nextInput = document.getElementById(next);
                if (currentInput && nextInput) {
                    currentInput.addEventListener('input', (e) => {
                        if (e.target.value.length === e.target.maxLength) {
                            nextInput.focus();
                        }
                    });
                }
            });
        }

        setupPhoneAutoTab();

        // File upload handling
        const fileInput = document.getElementById('resume');
        const fileUploadArea = document.getElementById('fileUploadArea');
        const fileName = document.getElementById('fileName');
        
        // Store the file separately for drag-and-drop
        let droppedFile = null;

        fileUploadArea.addEventListener('click', () => fileInput.click());

        fileUploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileUploadArea.style.borderColor = 'var(--accent)';
        });

        fileUploadArea.addEventListener('dragleave', () => {
            fileUploadArea.style.borderColor = 'var(--border)';
        });

        fileUploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileUploadArea.style.borderColor = 'var(--border)';
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                droppedFile = files[0];
                fileName.textContent = files[0].name;
            }
        });

        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                droppedFile = null; // Clear dropped file if user selects via button
                fileName.textContent = e.target.files[0].name;
            }
        });

        // Step navigation
        function showStep(step) {
            document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));
            document.querySelector(`[data-step="${step}"]`).classList.add('active');
            
            // Track step view for analytics
            trackStepView(step);
            
            // Update progress bar
            const progress = ((step - 1) / (totalSteps - 1)) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            
            // Update time estimate
            updateTimeEstimate();
            
            // Update buttons
            document.getElementById('prevBtn').style.display = step === 1 ? 'none' : 'block';
            document.getElementById('nextBtn').style.display = step === totalSteps ? 'none' : 'block';
            document.getElementById('submitBtn').style.display = step === totalSteps ? 'block' : 'none';
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // Drop-off tracking
        const stepTracking = {
            sessionId: generateSessionId(),
            steps: [],
            startTime: new Date().getTime()
        };
        
        function generateSessionId() {
            return 'session_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }
        
        function trackStepView(step) {
            const timestamp = new Date().getTime();
            const timeOnPrevious = stepTracking.steps.length > 0 
                ? timestamp - stepTracking.steps[stepTracking.steps.length - 1].timestamp
                : 0;
            
            stepTracking.steps.push({
                step: step,
                timestamp: timestamp,
                timeOnPrevious: timeOnPrevious
            });
            
            // Store in localStorage for analysis
            localStorage.setItem('stepTracking', JSON.stringify(stepTracking));
            
            console.log(`ðŸ“Š Step ${step} viewed | Time on previous: ${Math.round(timeOnPrevious/1000)}s`);
        }
        
        // Track abandonment when user leaves
        window.addEventListener('beforeunload', () => {
            if (currentStep < totalSteps) {
                const abandonData = {
                    sessionId: stepTracking.sessionId,
                    abandonedAt: currentStep,
                    totalTime: new Date().getTime() - stepTracking.startTime,
                    stepHistory: stepTracking.steps
                };
                
                // Send abandonment data (beacon for reliability)
                if (navigator.sendBeacon && typeof GOOGLE_SHEETS_URL !== 'undefined') {
                    const data = new Blob([JSON.stringify({
                        type: 'abandonment',
                        data: abandonData
                    })], { type: 'application/json' });
                    navigator.sendBeacon(GOOGLE_SHEETS_URL, data);
                }
                
                console.log('ðŸ“‰ Form abandoned at step', currentStep);
            }
        });

        function validateStep(step) {
            console.log('validateStep called for step:', step);
            const currentStepEl = document.querySelector(`[data-step="${step}"]`);
            console.log('Current step element:', currentStepEl);
            
            const requiredInputs = currentStepEl.querySelectorAll('[required]');
            console.log('Found required inputs:', requiredInputs.length);
            
            for (let input of requiredInputs) {
                console.log('Checking input:', input.name, 'Valid:', input.checkValidity(), 'Value:', input.value);
                if (!input.checkValidity()) {
                    console.log('Input failed validation:', input.name);
                    input.reportValidity();
                    return false;
                }
            }
            console.log('All inputs valid!');
            return true;
        }

        document.getElementById('nextBtn').addEventListener('click', () => {
            console.log('Next button clicked! Current step:', currentStep);
            console.log('Validating step...');
            
            if (validateStep(currentStep)) {
                console.log('Validation passed! Moving to next step.');
                currentStep++;
                showStep(currentStep);
            } else {
                console.log('Validation failed!');
            }
        });

        document.getElementById('prevBtn').addEventListener('click', () => {
            currentStep--;
            showStep(currentStep);
        });

        // Calculate BIO score
        // Advanced BIO Scoring: Six Unmeasurables Breakdown
        function calculateBIOScore(formData) {
            const scores = {
                initiative: 0,
                professionalism: 0,
                ownership: 0,
                followThrough: 0,
                interest: 0,
                presence: 0
            };
            
            const maxScores = {
                initiative: 100,
                professionalism: 100,
                ownership: 100,
                followThrough: 100,
                interest: 100,
                presence: 100
            };
            
            // BIO Question 1: Obstacle Response
            // Maps to: Ownership (50%), Initiative (30%), Follow-Through (20%)
            const q1Score = parseInt(formData.bio_1) || 0;
            scores.ownership += (q1Score / 5) * 50;
            scores.initiative += (q1Score / 5) * 30;
            scores.followThrough += (q1Score / 5) * 20;
            
            // BIO Question 2: Repetitive Work (text response)
            // Maps to: Follow-Through (40%), Presence (30%), Interest (30%)
            const q2Text = formData.bio_2 || '';
            const q2Analysis = analyzeTextResponse(q2Text, ['repetitive', 'boring', 'monotonous']);
            scores.followThrough += q2Analysis.score * 40;
            scores.presence += q2Analysis.score * 30;
            scores.interest += q2Analysis.score * 30;
            
            // BIO Question 3: Critical Feedback Response
            // Maps to: Ownership (40%), Professionalism (40%), Initiative (20%)
            const q3Score = parseInt(formData.bio_3) || 0;
            scores.ownership += (q3Score / 5) * 40;
            scores.professionalism += (q3Score / 5) * 40;
            scores.initiative += (q3Score / 5) * 20;
            
            // BIO Question 4: Interruption Handling
            // Maps to: Presence (50%), Follow-Through (30%), Professionalism (20%)
            const q4Score = parseInt(formData.bio_4) || 0;
            scores.presence += (q4Score / 5) * 50;
            scores.followThrough += (q4Score / 5) * 30;
            scores.professionalism += (q4Score / 5) * 20;
            
            // BIO Question 5: Mistake Response (text response)
            // Maps to: Ownership (50%), Professionalism (30%), Initiative (20%)
            const q5Text = formData.bio_5 || '';
            const q5Analysis = analyzeTextResponse(q5Text, ['mistake', 'error', 'wrong']);
            scores.ownership += q5Analysis.score * 50;
            scores.professionalism += q5Analysis.score * 30;
            scores.initiative += q5Analysis.score * 20;
            
            // Normalize scores to 0-100 range
            for (let key in scores) {
                scores[key] = Math.min(Math.round(scores[key]), 100);
            }
            
            // Calculate overall score (average of all six)
            const overallScore = Math.round(
                (scores.initiative + scores.professionalism + scores.ownership + 
                 scores.followThrough + scores.interest + scores.presence) / 6
            );
            
            // Consistency check
            const consistencyFlags = checkConsistency(formData, scores);
            
            // Store detailed breakdown (we'll send this to Google Sheets)
            return {
                overall: overallScore,
                breakdown: scores,
                consistency: consistencyFlags,
                // For backward compatibility
                valueOf: function() { return this.overall; }
            };
        }
        
        // Advanced text response analysis
        function analyzeTextResponse(text, contextKeywords = []) {
            if (!text || text.trim().length === 0) {
                return { score: 0, flags: ['no_response'] };
            }
            
            let score = 0;
            const flags = [];
            const lowerText = text.toLowerCase();
            
            // Length scoring (0-0.4 points)
            if (text.length < 30) {
                score += 0.1;
                flags.push('very_short');
            } else if (text.length < 80) {
                score += 0.2;
                flags.push('short');
            } else if (text.length < 150) {
                score += 0.3;
            } else {
                score += 0.4;
            }
            
            // Specificity - mentions numbers, names, timeframes (0-0.2 points)
            const hasNumbers = /\d+/.test(text);
            const hasTimeframe = /(month|week|year|day|hour)s?/i.test(text);
            if (hasNumbers || hasTimeframe) {
                score += 0.2;
            } else {
                flags.push('lacks_specificity');
            }
            
            // Maturity indicators (0-0.3 points)
            const maturityKeywords = [
                'learned', 'improved', 'realized', 'understood', 'discovered',
                'responsibility', 'accountable', 'ownership',
                'solution', 'resolved', 'corrected', 'fixed',
                'feedback', 'growth', 'development', 'better'
            ];
            
            let maturityCount = 0;
            maturityKeywords.forEach(keyword => {
                if (lowerText.includes(keyword)) {
                    maturityCount++;
                }
            });
            
            score += Math.min(maturityCount * 0.1, 0.3);
            
            // Red flags - negative indicators (subtract points)
            const redFlags = [
                { pattern: /\bnot (my|our) fault\b/i, penalty: 0.2, flag: 'blame_shifting' },
                { pattern: /\b(just|simply) (did|do) it\b/i, penalty: 0.1, flag: 'vague_generic' },
                { pattern: /\bdon'?t (really |usually )?make mistakes\b/i, penalty: 0.3, flag: 'no_accountability' },
                { pattern: /\b(boring|stupid|dumb|hate)\b/i, penalty: 0.1, flag: 'negative_language' },
                { pattern: /\b(idk|dunno|whatever)\b/i, penalty: 0.2, flag: 'dismissive' }
            ];
            
            redFlags.forEach(flag => {
                if (flag.pattern.test(lowerText)) {
                    score -= flag.penalty;
                    flags.push(flag.flag);
                }
            });
            
            // First-person perspective check (0-0.1 points)
            const hasFirstPerson = /\b(i|my|me)\b/i.test(text);
            if (hasFirstPerson) {
                score += 0.1;
            } else {
                flags.push('third_person');
            }
            
            // Clamp score to 0-1 range
            score = Math.max(0, Math.min(1, score));
            
            return { score, flags };
        }
        
        // Consistency checking across answers
        function checkConsistency(formData, scores) {
            const flags = [];
            
            // Check 1: High self-assessment on handling feedback (Q3) but low ownership score
            const q3 = parseInt(formData.bio_3) || 0;
            if (q3 >= 4 && scores.ownership < 50) {
                flags.push({
                    type: 'feedback_ownership_mismatch',
                    severity: 'medium',
                    message: 'Claims to handle feedback well but low ownership in examples'
                });
            }
            
            // Check 2: High interruption tolerance (Q4) but low presence score
            const q4 = parseInt(formData.bio_4) || 0;
            if (q4 >= 4 && scores.presence < 50) {
                flags.push({
                    type: 'interruption_presence_mismatch',
                    severity: 'medium',
                    message: 'Claims to handle interruptions well but low presence indicators'
                });
            }
            
            // Check 3: Obstacle handling (Q1) vs. actual problem-solving in text
            const q1 = parseInt(formData.bio_1) || 0;
            const q5Text = (formData.bio_5 || '').toLowerCase();
            const hasSolution = /\b(fix|solve|correct|address|resolve)\w*/i.test(q5Text);
            if (q1 >= 4 && !hasSolution && q5Text.length > 50) {
                flags.push({
                    type: 'obstacle_action_mismatch',
                    severity: 'high',
                    message: 'Claims proactive obstacle handling but mistake story lacks solution focus'
                });
            }
            
            // Check 4: All dropdown answers are 5s (perfect scores) - possible gaming
            if (q1 === 5 && q3 === 5 && q4 === 5) {
                const q2Length = (formData.bio_2 || '').length;
                const q5Length = (formData.bio_5 || '').length;
                if (q2Length < 100 || q5Length < 100) {
                    flags.push({
                        type: 'perfect_scores_short_answers',
                        severity: 'high',
                        message: 'All perfect dropdown scores but minimal text detail - possible gaming'
                    });
                }
            }
            
            // Check 5: Text response quality mismatch
            const q2Analysis = analyzeTextResponse(formData.bio_2 || '');
            const q5Analysis = analyzeTextResponse(formData.bio_5 || '');
            
            if (q2Analysis.flags.includes('very_short') && q5Analysis.flags.includes('very_short')) {
                flags.push({
                    type: 'minimal_effort',
                    severity: 'medium',
                    message: 'Both text responses are very short - possible lack of engagement'
                });
            }
            
            // Check 6: Red flags in either text response
            const allFlags = [...q2Analysis.flags, ...q5Analysis.flags];
            const redFlagCount = allFlags.filter(f => 
                ['blame_shifting', 'no_accountability', 'dismissive'].includes(f)
            ).length;
            
            if (redFlagCount >= 2) {
                flags.push({
                    type: 'multiple_red_flags',
                    severity: 'high',
                    message: 'Multiple concerning patterns in text responses'
                });
            }
            
            return flags;
        }

        // Form submission
        document.getElementById('applicationForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (!validateStep(currentStep)) {
                return;
            }

            // Spam protection: Check honeypot field
            const honeypot = document.getElementById('website_url');
            if (honeypot && honeypot.value !== '') {
                console.log('Spam detected - honeypot field filled');
                // Silently fail for bots - don't show error
                return;
            }

            // Show loading screen
            document.getElementById('applicationForm').style.display = 'none';
            document.getElementById('loadingScreen').classList.add('active');

            // Collect form data
            const formElement = document.getElementById('applicationForm');
            const formDataObj = new FormData(formElement);
            const data = {};
            
            for (let [key, value] of formDataObj.entries()) {
                // Skip the file input - we'll handle it separately
                if (key !== 'resume') {
                    data[key] = value;
                }
            }

            // Handle resume file upload
            const fileInput = document.getElementById('resume');
            let fileToUpload = null;
            
            // Check if file was dropped or selected via input
            if (droppedFile) {
                fileToUpload = droppedFile;
            } else if (fileInput.files && fileInput.files[0]) {
                fileToUpload = fileInput.files[0];
            }
            
            if (fileToUpload) {
                console.log('Processing resume file:', fileToUpload.name);
                try {
                    // Check file size (10MB limit)
                    if (fileToUpload.size > 10 * 1024 * 1024) {
                        alert('Resume file is too large. Please use a file smaller than 10MB.');
                        document.getElementById('loadingScreen').classList.remove('active');
                        document.getElementById('applicationForm').style.display = 'block';
                        return;
                    }
                    
                    // Convert file to base64
                    const base64 = await new Promise((resolve, reject) => {
                        const reader = new FileReader();
                        reader.onload = () => {
                            // Remove the data URL prefix to get just the base64 string
                            const base64String = reader.result.split(',')[1];
                            resolve(base64String);
                        };
                        reader.onerror = reject;
                        reader.readAsDataURL(fileToUpload);
                    });
                    
                    data.resumeFile = base64;
                    data.resumeFileName = fileToUpload.name;
                    console.log('Resume converted to base64, size:', base64.length);
                } catch (error) {
                    console.error('Error processing resume:', error);
                    // Continue without resume if there's an error
                    data.resumeFile = null;
                    data.resumeFileName = null;
                }
            } else {
                data.resumeFile = null;
                data.resumeFileName = null;
                console.log('No resume file uploaded');
            }

            // Add timestamp
            data.submitted_at = new Date().toISOString();

            // Calculate BIO score with Six Unmeasurables breakdown
            const bioScoreObj = calculateBIOScore(data);
            const bioScore = bioScoreObj.overall;
            data.bio_score = bioScore;
            data.bio_breakdown = bioScoreObj.breakdown;
            data.consistency_flags = bioScoreObj.consistency;

            // Determine routing
            let routing = '';
            let message = '';
            let nextSteps = '';
            
            if (bioScore >= 75) {
                routing = 'Priority - High Capacity';
                message = 'Excellent! Your responses indicate strong work capacity and psychological maturity.';
                nextSteps = 'Our team will prioritize your application and contact you within 2-3 business days to discuss immediate opportunities.';
            } else if (bioScore >= 50) {
                routing = 'Standard - Good Potential';
                message = 'Good! Your responses show solid work fundamentals with room for development.';
                nextSteps = 'We will review your application and contact you within 5-7 business days. You may also be invited to participate in our working interview program.';
            } else {
                routing = 'Development - Needs Support';
                message = 'Thank you for your honesty. Your responses suggest you may benefit from our developmental programs.';
                nextSteps = 'We will review your application for positions that include training and mentorship. We may also contact you about our workforce development initiatives.';
            }
            
            data.routing_category = routing;

            // Format data for Google Sheets
            const sheetData = {
                timestamp: data.submitted_at,
                bio_score: bioScore,
                routing: routing,
                // Six Unmeasurables breakdown
                initiative: bioScoreObj.breakdown.initiative,
                professionalism: bioScoreObj.breakdown.professionalism,
                ownership: bioScoreObj.breakdown.ownership,
                followThrough: bioScoreObj.breakdown.followThrough,
                interest: bioScoreObj.breakdown.interest,
                presence: bioScoreObj.breakdown.presence,
                // Consistency flags (JSON string)
                consistency_flags: JSON.stringify(bioScoreObj.consistency),
                consistency_count: bioScoreObj.consistency.length,
                name: data.legal_name,
                email: data.email,
                phone: `${data.phone_1}-${data.phone_2}-${data.phone_3}`,
                address: `${data.address_1}, ${data.city}, ${data.state} ${data.zip}`,
                age_18: data.age_18,
                work_eligible: data.work_eligible,
                proof_eligible: data.proof_eligible,
                dl_number: data.dl_number,
                dl_state: data.dl_state,
                emergency_contact: data.emergency_contact,
                emergency_phone: `${data.emerg_phone_1}-${data.emerg_phone_2}-${data.emerg_phone_3}`,
                hear_about: data.hear_about,
                referral: data.referral_name,
                salary_expectation: data.salary_expectation,
                job_type: data.job_type,
                start_date: data.start_date,
                preferred_position: data.preferred_position,
                monday: data.monday,
                tuesday: data.tuesday,
                wednesday: data.wednesday,
                thursday: data.thursday,
                friday: data.friday,
                saturday: data.saturday,
                sunday: data.sunday,
                bio_1: data.bio_1,
                bio_2: data.bio_2,
                bio_3: data.bio_3,
                bio_4: data.bio_4,
                bio_5: data.bio_5,
                work_experience: data.work_experience,
                references: data.references,
                education: data.education,
                skills: data.skills,
                certifications: data.certifications,
                certification: data.certification
            };

            // IMPORTANT: Replace this URL with your Google Apps Script Web App URL
            // After deploying the script, you'll get a URL that looks like:
            // https://script.google.com/macros/s/AKfycbx.../exec
            const GOOGLE_SHEETS_URL = 'PASTE_YOUR_WEB_APP_URL_HERE';

            try {
                // Submit to Google Sheets
                const response = await fetch(GOOGLE_SHEETS_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(sheetData)
                });

                // Note: 'no-cors' mode means we won't get a response, but the data will be sent
                // Wait a moment for submission to process
                await new Promise(resolve => setTimeout(resolve, 1500));

                // Hide loading, show success
                document.getElementById('loadingScreen').classList.remove('active');
                document.getElementById('successScreen').classList.add('active');

                // Animate score
                setTimeout(() => {
                    document.getElementById('scoreFill').style.width = bioScore + '%';
                    document.getElementById('scoreText').textContent = bioScore + '%';
                }, 500);

                // Set messages
                document.getElementById('scoreMessage').textContent = message;
                document.getElementById('nextSteps').textContent = nextSteps;

                // Clear saved data
                localStorage.removeItem('peakApplication');

                // Log to console for testing
                console.log('Application Data:', sheetData);

            } catch (error) {
                console.error('Error submitting application:', error);
                alert('There was an error submitting your application. Please try again or contact team@peaktcs.com for assistance.');
                document.getElementById('loadingScreen').classList.remove('active');
                document.getElementById('applicationForm').style.display = 'block';
            }
        });
        
        // Initialize enhanced features on page load
        document.addEventListener('DOMContentLoaded', () => {
            setupCharCounters();
            setupHelpTextToggles();
            updateTimeEstimate();
            console.log('Enhanced features initialized: Character counters, help text, time estimates');
        });
    </script>
</body>
</html>
